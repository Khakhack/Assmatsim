<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚ûï Ajouter un enfant</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="container">
    <h1>‚ûï Ajouter un enfant</h1>
    <form id="formulaireEnfant" class="form-container">
      <input type="text" id="prenom" placeholder="Pr√©nom" required>
      <input type="text" id="nom" placeholder="Nom" required>
      <input type="date" id="dateNaissance" placeholder="Date de naissance" required>
      <input type="text" id="nomParent" placeholder="Nom du parent" required>
      <input type="tel" id="telephone" placeholder="T√©l√©phone" required>

      <select id="typeContrat">
        <option value="Complet">Contrat Complet</option>
        <option value="Incomplet">Contrat Incomplet</option>
      </select>

      <select id="cdiCdd">
        <option value="CDI">CDI</option>
        <option value="CDD">CDD</option>
      </select>

      <input type="date" id="dateDebutContrat" placeholder="Date de d√©but de contrat" required>
      <input type="number" id="heuresSemaine" placeholder="Nombre d'heures par semaine" required>
      <input type="number" id="joursSemaine" placeholder="Nombre de jours par semaine" required>

      <input type="number" id="montantHoraire" placeholder="Montant horaire (‚Ç¨)" required>
      <input type="number" id="majorationComplementaire" placeholder="Majoration heures compl√©mentaires (%)" required>
      <input type="number" id="majorationSupplementaire" placeholder="Majoration heures suppl√©mentaires (%)" required>

      <select id="repasFournis">
        <option value="Oui">Repas fournis par les parents</option>
        <option value="Non">Repas fournis par l'assmat</option>
      </select>

      <input type="number" id="prixRepas" placeholder="Prix du repas (‚Ç¨)">
      <input type="number" id="fraisEntretien" placeholder="Frais d'entretien (‚Ç¨)" required>

      <textarea id="remarques" placeholder="Remarques"></textarea>

      <button type="button" onclick="enregistrerEnfant()">‚úÖ Enregistrer</button>
    </form>

    <!-- Bouton retour -->
    <a href="index.html"><button type="button">üè† Retour √† l'accueil</button></a>
  </div>

  <script type="module">
    import { db } from './firebase.js';
    import { collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

    async function enregistrerEnfant() {
      const enfant = {
        prenom: document.getElementById('prenom').value,
        nom: document.getElementById('nom').value,
        dateNaissance: document.getElementById('dateNaissance').value,
        nomParent: document.getElementById('nomParent').value,
        telephone: document.getElementById('telephone').value,
        typeContrat: document.getElementById('typeContrat').value,
        cdiCdd: document.getElementById('cdiCdd').value,
        dateDebutContrat: document.getElementById('dateDebutContrat').value,
        heuresSemaine: document.getElementById('heuresSemaine').value,
        joursSemaine: document.getElementById('joursSemaine').value,
        montantHoraire: document.getElementById('montantHoraire').value,
        majorationComplementaire: document.getElementById('majorationComplementaire').value,
        majorationSupplementaire: document.getElementById('majorationSupplementaire').value,
        repasFournis: document.getElementById('repasFournis').value,
        prixRepas: document.getElementById('prixRepas').value,
        fraisEntretien: document.getElementById('fraisEntretien').value,
        remarques: document.getElementById('remarques').value,
        timestamp: serverTimestamp()
      };

      try {
        await addDoc(collection(db, "enfants"), enfant);
        alert("Enfant enregistr√© avec succ√®s !");
        window.location.href = "enfants.html";
      } catch (e) {
        console.error("Erreur lors de l'enregistrement :", e);
        alert("Erreur d'enregistrement, r√©essayez.");
      }
    }
  </script>

</body>
</html>
